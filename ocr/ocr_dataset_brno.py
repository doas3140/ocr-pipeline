# AUTOGENERATED! DO NOT EDIT! File to edit: nbs/64_ocr_dataset_brno.ipynb (unless otherwise specified).

__all__ = ['brno_ocr_config', 'create_df']

# Cell
from .core import *
from .core import save_dict, read_dict
from fastai import *
from fastai.vision import *
import pandas as pd
import numpy as np
import cv2
from tqdm.notebook import tqdm
from pathlib import PosixPath

# Cell
class brno_ocr_config:
    LINE_HEIGHT = 48
    MAIN_DIR = PosixPath('../data/brno/')
    LINES_DIR = PosixPath('../data/ocr/brno_lines/')
    FILE_PATH = PosixPath('../data/ocr/brno_gt.pickle')
    PAD = 0 # only for training
    TEST_PAD = 0 # optional, can be set to zero

# Cell
def create_df():
    data = []
    for data_split in ['train', 'valid', 'test']:
        if data_split == 'test': continue
        for difficulty in ['easy', 'medium', 'hard']:
            data_info = data_split +'.'+ difficulty
            with open(brno_ocr_config.MAIN_DIR/'lines'/data_info, "r") as f:
                lines = f.readlines()
                for line in lines:
                    fn,*string = line[:-1].split(' ')
                    string = ' '.join(string)
                    fn = brno_ocr_config.LINES_DIR/fn
                    data.append((fn, string, 'valid' in data_info, 'brno_'+difficulty))
    return pd.DataFrame(data, columns=['image_path', 'string', 'valid', 'dataset'])